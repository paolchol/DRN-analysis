```{r, setwd, include = FALSE}
knitr::opts_knit$set(root.dir = "C:/Directory_thesis_codes")
setwd("C:/DRN_analysis")
knitr::opts_knit$set(root.dir = "C:/DRN_analysis")
setwd("C:/DRN_analysis")
setwd("C:/DRN_analysis")
source("./R/Libraries/Libraries.R")
knitr::opts_knit$set(root.dir = "C:/DRN_analysis")
```{r, setup, include = FALSE}
# setwd("C:/DRN_analysis")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Functions_MC.R")
# setwd("C:/DRN_analysis")
source("./R/Libraries/Libraries.R")
knitr::opts_knit$set(root.dir = "C:/DRN_analysis")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Functions_MC.R")
setwd("C:/DRN_analysis")
setwd("C:/DRN_analysis")
# setwd("C:/DRN_analysis")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Functions_MC.R")
cwd
getcwd()
getwd()
knitr::opts_knit$set(root.dir = "C:/DRN_analysis")
getwd()
gc()
setwd(C:\DRN-analysis)
setwd("C:\DRN-analysis")
setwd("C:/DRN-analysis")
knitr::opts_knit$set(root.dir = "C:/DRN-analysis")
getwd()
source("./R/Libraries/Libraries_plot.R")
setwd("C:/DRN-analysis")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
getwd()
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Functions_MC.R")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Libraries.R")
source("./R/Libraries/Libraries_plot.R")
source("./R/Libraries/Functions.R")
source("./R/Libraries/Functions_MC.R")
![Graphical representation of the Drought Cycle Analysis, from Ribeiro Neto et al. (2022). WSI: Water Scarcity Index, PI: Precipitation Index.](C:/DRN-analysis/Figures and tables/paper/Figure_2.jpg){width="682"}
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 6) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
setwd("C:/DRN-analysis")
#Custom functions
#Moving average
ma <- function(x, n = 5){stats::filter(x, rep(1 / n, n), sides = 2)}
#Find the lower and upper bounds
find_bounds = function(df, x = 1, skip = 0, ma = FALSE, n = 5){
minx <- function(x) min(x, na.rm = TRUE)
maxx <- function(x) max(x, na.rm = TRUE)
skip <- skip + 1
lowbound <- apply(df[, skip:ncol(df)], x, minx)
highbound <- apply(df[, skip:ncol(df)], x, maxx)
if(ma){
lowbound <- ma(lowbound, n)
highbound <- ma(highbound, n)
}
bounds <- data.frame(date = df$date, low = lowbound, high = highbound)
return(bounds)
}
#Cunstruct the dataframe
DCA_AR <- list.load("./Data/Analysis/DCA/DCA_AR.RData")
df <- data.frame(date = DCA_AR$Banabuiu$date)
for(i in seq_len(length(DCA_AR))){
df$new <- DCA_AR[[i]]$PI
names(df)[names(df) == "new"] <- names(DCA_AR)[i]
}
newdf <- df[, 1:ncol(df)-1]
bounds <- find_bounds(newdf, 1, 1, ma = TRUE, 6)
bounds[bounds == Inf | bounds == -Inf] <- 0
df <- df[, c(1, ncol(df))]
df$lowbound <- bounds$low
df$highbound <- bounds$high
df$ma <- ma(df$Banabuiu, 6)
df <- df[14:nrow(df), ]
#Plot
col <- c("Mean precipitation" = "#293462",
"Sub-basin variation" = "#F24C4C")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 6) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 6) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
print(p)
plot.save(p, width = 1920, height = 1080, filename = "./Figures and tables/paper/Figure_5_new.png")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 8) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
setwd("C:/DRN-analysis")
#Custom functions
#Moving average
ma <- function(x, n = 5){stats::filter(x, rep(1 / n, n), sides = 2)}
#Find the lower and upper bounds
find_bounds = function(df, x = 1, skip = 0, ma = FALSE, n = 5){
minx <- function(x) min(x, na.rm = TRUE)
maxx <- function(x) max(x, na.rm = TRUE)
skip <- skip + 1
lowbound <- apply(df[, skip:ncol(df)], x, minx)
highbound <- apply(df[, skip:ncol(df)], x, maxx)
if(ma){
lowbound <- ma(lowbound, n)
highbound <- ma(highbound, n)
}
bounds <- data.frame(date = df$date, low = lowbound, high = highbound)
return(bounds)
}
#Cunstruct the dataframe
DCA_AR <- list.load("./Data/Analysis/DCA/DCA_AR.RData")
df <- data.frame(date = DCA_AR$Banabuiu$date)
for(i in seq_len(length(DCA_AR))){
df$new <- DCA_AR[[i]]$PI
names(df)[names(df) == "new"] <- names(DCA_AR)[i]
}
newdf <- df[, 1:ncol(df)-1]
bounds <- find_bounds(newdf, 1, 1, ma = TRUE, 6)
bounds[bounds == Inf | bounds == -Inf] <- 0
df <- df[, c(1, ncol(df))]
df$lowbound <- bounds$low
df$highbound <- bounds$high
df$ma <- ma(df$Banabuiu, 6)
df <- df[14:nrow(df), ]
#Plot
col <- c("Mean precipitation" = "#293462",
"Sub-basin variation" = "#F24C4C")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 8) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
print(p)
plot.save(p, width = 1920, height = 1080, filename = "./Figures and tables/paper/Figure_5_new.png")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 8) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24, face = "bold"),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
setwd("C:/DRN-analysis")
#Custom functions
#Moving average
ma <- function(x, n = 5){stats::filter(x, rep(1 / n, n), sides = 2)}
#Find the lower and upper bounds
find_bounds = function(df, x = 1, skip = 0, ma = FALSE, n = 5){
minx <- function(x) min(x, na.rm = TRUE)
maxx <- function(x) max(x, na.rm = TRUE)
skip <- skip + 1
lowbound <- apply(df[, skip:ncol(df)], x, minx)
highbound <- apply(df[, skip:ncol(df)], x, maxx)
if(ma){
lowbound <- ma(lowbound, n)
highbound <- ma(highbound, n)
}
bounds <- data.frame(date = df$date, low = lowbound, high = highbound)
return(bounds)
}
#Cunstruct the dataframe
DCA_AR <- list.load("./Data/Analysis/DCA/DCA_AR.RData")
df <- data.frame(date = DCA_AR$Banabuiu$date)
for(i in seq_len(length(DCA_AR))){
df$new <- DCA_AR[[i]]$PI
names(df)[names(df) == "new"] <- names(DCA_AR)[i]
}
newdf <- df[, 1:ncol(df)-1]
bounds <- find_bounds(newdf, 1, 1, ma = TRUE, 6)
bounds[bounds == Inf | bounds == -Inf] <- 0
df <- df[, c(1, ncol(df))]
df$lowbound <- bounds$low
df$highbound <- bounds$high
df$ma <- ma(df$Banabuiu, 6)
df <- df[14:nrow(df), ]
#Plot
col <- c("Mean precipitation" = "#293462",
"Sub-basin variation" = "#F24C4C")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 8) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24, face = "bold"),
axis.title.x = element_blank(),
legend.title = element_text(size = 20),
legend.text = element_text(size = 18),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
print(p)
plot.save(p, width = 1920, height = 1080, filename = "./Figures and tables/paper/Figure_5_new.png")
setwd("C:/DRN-analysis")
#Custom functions
#Moving average
ma <- function(x, n = 5){stats::filter(x, rep(1 / n, n), sides = 2)}
#Find the lower and upper bounds
find_bounds = function(df, x = 1, skip = 0, ma = FALSE, n = 5){
minx <- function(x) min(x, na.rm = TRUE)
maxx <- function(x) max(x, na.rm = TRUE)
skip <- skip + 1
lowbound <- apply(df[, skip:ncol(df)], x, minx)
highbound <- apply(df[, skip:ncol(df)], x, maxx)
if(ma){
lowbound <- ma(lowbound, n)
highbound <- ma(highbound, n)
}
bounds <- data.frame(date = df$date, low = lowbound, high = highbound)
return(bounds)
}
#Cunstruct the dataframe
DCA_AR <- list.load("./Data/Analysis/DCA/DCA_AR.RData")
df <- data.frame(date = DCA_AR$Banabuiu$date)
for(i in seq_len(length(DCA_AR))){
df$new <- DCA_AR[[i]]$PI
names(df)[names(df) == "new"] <- names(DCA_AR)[i]
}
newdf <- df[, 1:ncol(df)-1]
bounds <- find_bounds(newdf, 1, 1, ma = TRUE, 6)
bounds[bounds == Inf | bounds == -Inf] <- 0
df <- df[, c(1, ncol(df))]
df$lowbound <- bounds$low
df$highbound <- bounds$high
df$ma <- ma(df$Banabuiu, 6)
df <- df[14:nrow(df), ]
#Plot
col <- c("Mean precipitation" = "#293462",
"Sub-basin variation" = "#F24C4C")
p <- ggplot() +
#Add the droughts rectangles
# geom_rect(data = date_ranges, aes(xmin = from, xmax = to, ymin = -Inf, ymax = Inf), alpha = 0.4) +
#Add the sub-basins variation
geom_ribbon(data = df, aes(x = date, ymin = lowbound, ymax = highbound, fill = "Sub-basin variation"), alpha = 0.5) +
#Add the mean line
geom_line(data = df, aes(x = date, y = ma, colour = "Mean precipitation"), size = 1.25) +
#Add the drought indicator lines
geom_hline(yintercept = 0, color = 'lightblue', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), 0, label = "Normal", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1, color = 'yellow', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1, label = "Moderately dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -1.5, color = 'orange', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -1.5, label = "Severely dry", vjust = -0.5, hjust = 0), size = 8) +
geom_hline(yintercept = -2, color = 'red', linetype = "dashed", size = 1.25, alpha = 0.8) +
geom_text(aes(as.Date("1985-01-01"), -2, label = "Extremely dry", vjust = -0.5, hjust = 0), size = 8) +
#Modify the axis
scale_y_continuous(name = 'SPI-12', limits = c(-4, 4), breaks = seq(-4, 4, 1)) +
scale_x_date(name = 'Date', date_breaks = "2 years", date_labels = '%Y', limits = as.Date(c("1980-01-01", "2018-12-01")), expand = c(0,0)) +
#Add the legend
scale_color_manual(name = "", values = col) +
scale_fill_manual(name = "", values = col) +
theme(
axis.text.x = element_text(size = 22),
axis.text.y = element_text(size = 22),
axis.title.y = element_text(size = 24, face = "bold"),
axis.title.x = element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 22),
legend.position = "bottom",
panel.background = element_rect(fill = "white", colour = "grey50")
)
print(p)
plot.save(p, width = 1920, height = 1080, filename = "./Figures and tables/paper/Figure_5_new.png")
